import{S as dn,i as cn,s as fn,y as h,a as c,k as l,q as r,z as v,c as f,l as s,m as n,r as a,h as o,n as p,A as b,b as d,G as t,H as pn,g as _,d as E,B as y}from"../chunks/index.a7566c1a.js";import{H as z}from"../chunks/HeadingLink.20322812.js";import{T as mn}from"../chunks/Toc.c31a36b6.js";import{C as at}from"../chunks/CodeBlock.a090ee9b.js";function un(nn){let R,Qt,fe,Zt,N,Qo,F,Zo,er,eo,P,tr,lt,or,rr,st,ar,lr,to,pe,oo,Be,M,sr,nt,nr,ir,it,dr,cr,ro,W,fr,Re,pr,mr,ao,H,I,ur,hr,vr,dt,br,_r,ct,Er,yr,$r,ft,gr,lo,me,so,Me,wr,no,m,Y,ue,pt,kr,xr,mt,Sr,Cr,Dr,Ge,he,ut,Ir,Pr,Ar,qe,ve,ht,jr,Or,Tr,Ve,be,vt,Jr,Lr,Br,ze,_e,bt,Rr,Mr,Gr,U,qr,Ee,Vr,zr,io,ye,co,x,Nr,_t,Fr,Wr,Et,Hr,Yr,yt,Ur,Xr,fo,A,Kr,$t,Qr,Zr,X,ea,ta,po,$e,mo,K,oa,gt,ra,aa,uo,ge,ho,we,vo,Q,la,wt,sa,na,bo,ke,_o,xe,ia,Eo,Z,da,kt,ca,fa,yo,Se,$o,Ce,go,$,pa,xt,ma,ua,ha,va,St,ba,_a,Ne,Ea,ya,wo,De,ko,G,Fe,Ct,$a,We,w,ga,Dt,wa,ka,It,xa,Sa,Pt,Ca,Da,At,Ia,Pa,xo,He,Aa,So,j,Ie,ja,jt,Oa,Ta,Ja,Pe,La,Ot,Ba,Ra,Ma,ee,Ga,Tt,qa,Va,Jt,za,Co,u,Na,Lt,Fa,Wa,Ha,Ya,te,Ua,Xa,oe,Ka,Qa,re,Za,el,Do,Ye,tl,Io,Ae,Po,Ue,Ao,je,jo,q,Xe,Bt,ol,Ke,Rt,rl,Oo,Oe,To,g,al,Mt,ll,sl,ae,nl,il,Gt,dl,cl,qt,fl,pl,Jo,O,ml,Te,ul,hl,Vt,vl,bl,Lo,Je,Bo,le,_l,se,El,yl,Ro,S,zt,$l,gl,V,wl,Nt,kl,xl,Ft,Sl,Cl,Dl,Le,Il,ne,Pl,Al,jl,k,Ol,Wt,Tl,Jl,Ht,Ll,Bl,Yt,Rl,Ml,Ut,Gl,ql,Mo;return R=new mn({}),fe=new z({props:{title:"JavaScript engine"}}),pe=new at({props:{content:`
        // pb_hooks/main.pb.js

        routerAdd("GET", "/hello/:name", (c) => {
            let name = c.pathParam("name")

            return c.json(200, { "message": "Hello " + name })
        })

        onModelAfterUpdate((e) => {
            console.log("user updated...", e.model.get("email"))
        }, "users")
    `}}),me=new z({props:{title:"Global objects",tag:"h5"}}),ye=new z({props:{title:"TypeScript declarations and code completion"}}),$e=new at({props:{content:`
        /// <reference path="../pb_data/types.d.ts" />

        onAfterBootstrap((e) => {
            console.log("App initialized!")
        })
    `}}),ge=new z({props:{title:"Caveats and limitations"}}),we=new z({props:{title:"Handlers scope",tag:"h5"}}),ke=new at({props:{content:`
        const name = "test"

        onAfterBootstrap((e) => {
            console.log(name) // <-- name will be undefined inside the handler
        })
    `}}),Se=new at({props:{content:`
        onAfterBootstrap((e) => {
            const config = require(\`\${__hooks}/config.js\`)

            console.log(config.name)
        })
    `}}),Ce=new z({props:{title:"Relative paths",tag:"h5"}}),De=new z({props:{title:"Loading modules",tag:"h5"}}),Ae=new at({props:{content:`
        // pb_hooks/utils.js
        module.exports = {
            hello: (name) => {
                console.log("Hello " + name)
            }
        }
    `}}),je=new at({props:{content:`
        // pb_hooks/main.pb.js
        onAfterBootstrap((e) => {
            const utils = require(\`\${__hooks}/utils.js\`)

            utils.hello("world")
        })
    `}}),Oe=new z({props:{title:"Performance",tag:"h5"}}),Je=new z({props:{title:"Engine limitations",tag:"h5"}}),{c(){h(R.$$.fragment),Qt=c(),h(fe.$$.fragment),Zt=c(),N=l("p"),Qo=r("The prebuilt PocketBase v0.17+ executable comes with embedded ES5 JavaScript engine ("),F=l("a"),Zo=r("goja"),er=r(") which enables you to write custom server-side code using plain JavaScript."),eo=c(),P=l("p"),tr=r("You can start by creating "),lt=l("code"),or=r("*.pb.js"),rr=r(" file(s) inside a "),st=l("code"),ar=r("pb_hooks"),lr=r(`
    directory next to your executable.`),to=c(),h(pe.$$.fragment),oo=c(),Be=l("p"),M=l("em"),sr=r("For convenience, when making changes to the files inside "),nt=l("code"),nr=r("pb_hooks"),ir=r(`, the process will
        automatically restart/reload itself (currently supported only on UNIX based platforms). The
        `),it=l("code"),dr=r("*.pb.js"),cr=r(" files are loaded per their filename sort order."),ro=c(),W=l("p"),fr=r("For most parts, the JavaScript APIs are derived from "),Re=l("a"),pr=r("Go"),mr=r(" with 2 main differences:"),ao=c(),H=l("ul"),I=l("li"),ur=r(`Go exported method and field names are converted to camelCase, for example:
        `),hr=l("br"),vr=c(),dt=l("code"),br=r('app.Dao().FindRecordById("example", "RECORD_ID")'),_r=r(` becomes
        `),ct=l("code"),Er=r('$app.dao().findRecordById("example", "RECORD_ID")'),yr=r("."),$r=c(),ft=l("li"),gr=r("Errors are thrown as regular JavaScript exceptions and not returned as Go values."),lo=c(),h(me.$$.fragment),so=c(),Me=l("p"),wr=r("Below is a list with some of the commonly used global objects that are accessible from everywhere:"),no=c(),m=l("ul"),Y=l("li"),ue=l("a"),pt=l("code"),kr=r("__hooks"),xr=r(`
        - The absolute path to the app `),mt=l("code"),Sr=r("pb_hooks"),Cr=r(" directory."),Dr=c(),Ge=l("li"),he=l("a"),ut=l("code"),Ir=r("$app"),Pr=r(" - The current running PocketBase application instance."),Ar=c(),qe=l("li"),ve=l("a"),ht=l("code"),jr=r("$apis.*"),Or=r(" - API routing helpers and middlewares."),Tr=c(),Ve=l("li"),be=l("a"),vt=l("code"),Jr=r("$os.*"),Lr=r(" - OS level primitives (deleting directories, executing shell commands, etc.)."),Br=c(),ze=l("li"),_e=l("a"),bt=l("code"),Rr=r("$security.*"),Mr=r(" - Low level helpers for creating and parsing JWTs, random string generation, AES encryption, etc."),Gr=c(),U=l("li"),qr=r(`And many more - for all exposed APIs, please refer to the
        `),Ee=l("a"),Vr=r("JSVM reference docs"),zr=r("."),io=c(),h(ye.$$.fragment),co=c(),x=l("p"),Nr=r("While you can't use directly TypeScript ("),_t=l("em"),Fr=r("without transpiling it to JS on your own"),Wr=r(`), PocketBase
    comes with builtin `),Et=l("strong"),Hr=r("ambient TypeScript declarations"),Yr=r(` that can help providing information
    and documentation about the available global variables, methods and arguments, code completion, etc. as
    long as your editor has TypeScript LSP support
    `),yt=l("em"),Ur=r("(most editors either have it builtin or available as plugin)"),Xr=r("."),fo=c(),A=l("p"),Kr=r(`The types declarations are stored in
    `),$t=l("code"),Qr=r("pb_data/types.d.ts"),Zr=r(` file. You can point to those declarations using the
    `),X=l("a"),ea=r("reference tripple-slash directive"),ta=r(`
    at the top of your JS file:`),po=c(),h($e.$$.fragment),mo=c(),K=l("p"),oa=r(`If after referencing the types your editor still doesn't perform linting, then you can try to rename your
    file to have `),gt=l("code"),ra=r(".pb.ts"),aa=r(" extension."),uo=c(),h(ge.$$.fragment),ho=c(),h(we.$$.fragment),vo=c(),Q=l("p"),la=r(`Each handler function (hook, route, middleware, etc.) is
    `),wt=l("strong"),sa=r('serialized and executed in its own isolated context as a separate "program"'),na=r(`. This means
    that you don't have access to custom variables and functions declared outside of the handler scope. For
    example, the below code will fail:`),bo=c(),h(ke.$$.fragment),_o=c(),xe=l("p"),ia=r(`The above serialization and isolation context is also the reason why error stack trace line numbers may
    not be accurate.`),Eo=c(),Z=l("p"),da=r(`One possible workaround for sharing/reusing code across different handlers could be to move and export the
    reusable code portion as local module and load it with `),kt=l("code"),ca=r("require()"),fa=r(` inside the handler but keep in
    mind that the loaded modules use a shared registry and mutations should be avoided when possible to prevent
    concurrency issues:`),yo=c(),h(Se.$$.fragment),$o=c(),h(Ce.$$.fragment),go=c(),$=l("p"),pa=r(`Relative file paths are relative to the current working directory (CWD) and not to the
    `),xt=l("code"),ma=r("pb_hooks"),ua=r(`.
    `),ha=l("br"),va=r(`
    To get an absolute path to the `),St=l("code"),ba=r("pb_hooks"),_a=r(` directory you can use the global
    `),Ne=l("code"),Ea=r("__hooks"),ya=r(" variable."),wo=c(),h(De.$$.fragment),ko=c(),G=l("div"),Fe=l("div"),Ct=l("i"),$a=c(),We=l("div"),w=l("p"),ga=r(`Please note that the embedded JavaScript engine is not a Node.js or browser environment, meaning
            that modules that relies on APIs like `),Dt=l("em"),wa=r("window"),ka=r(", "),It=l("em"),xa=r("fs"),Sa=r(`,
            `),Pt=l("em"),Ca=r("fetch"),Da=r(", "),At=l("em"),Ia=r("buffer"),Pa=r(` or any other runtime specific API not part of the ES5 spec may not
            work!`),xo=c(),He=l("p"),Aa=r(`You can load modules either by specifying their local filesystem path or by using their name, which will
    automatically search in:`),So=c(),j=l("ul"),Ie=l("li"),ja=r("the current working directory ("),jt=l("em"),Oa=r("affects also relative paths"),Ta=r(")"),Ja=c(),Pe=l("li"),La=r("any "),Ot=l("code"),Ba=r("node_modules"),Ra=r(" directory"),Ma=c(),ee=l("li"),Ga=r("any parent "),Tt=l("code"),qa=r("node_modules"),Va=r(" directory, up to the closest "),Jt=l("code"),za=r("package.json"),Co=c(),u=l("p"),Na=r(`Currently only CommonJS (CJS) modules are supported and can be loaded with
    `),Lt=l("code"),Fa=r("const x = require(...)"),Wa=r(`.
    `),Ha=l("br"),Ya=r(`
    ECMAScript modules (ESM) can be loaded by first precompiling and transforming your dependencies with a bundler
    like
    `),te=l("a"),Ua=r("rollup"),Xa=r(`,
    `),oe=l("a"),Ka=r("webpack"),Qa=r(`,
    `),re=l("a"),Za=r("browserify"),el=r(", etc."),Do=c(),Ye=l("p"),tl=r("A common usage of local modules is for loading shared helpers or configuration parameters, for example:"),Io=c(),h(Ae.$$.fragment),Po=c(),Ue=l("div"),Ao=c(),h(je.$$.fragment),jo=c(),q=l("div"),Xe=l("div"),Bt=l("i"),ol=c(),Ke=l("div"),Rt=l("p"),rl=r(`Loaded modules use a shared registry and mutations should be avoided when possible to prevent
            concurrency issues.`),Oo=c(),h(Oe.$$.fragment),To=c(),g=l("p"),al=r("The prebuilt executable comes with a "),Mt=l("strong"),ll=r("prewarmed pool of 25 JS runtimes"),sl=r(`, which helps
    maintaining the handlers execution times on par with the Go equivalent code (see
    `),ae=l("a"),nl=r("benchmarks"),il=r("). You can adjust the pool size manually with the "),Gt=l("code"),dl=r("--hooksPool=100"),cl=r(" flag ("),qt=l("em"),fl=r(`increasing the pool size may improve the performance in high concurrent scenarios but also will
        increase the memory usage`),pl=r(")."),Jo=c(),O=l("p"),ml=r(`Note that the handlers performance may degrade if you have heavy computational tasks in pure JavaScript
    (eg. encryption, random generators, etc.). For such cases prefer using the exposed `),Te=l("a"),ul=r("Go bindings"),hl=r(`
    (eg. `),Vt=l("code"),vl=r("$security.randomString(10)"),bl=r(")."),Lo=c(),h(Je.$$.fragment),Bo=c(),le=l("p"),_l=r(`We inherit some of the limitations and caveats of the embedded JavaScript engine
    
    (`),se=l("a"),El=r("goja"),yl=r("):"),Ro=c(),S=l("ul"),zt=l("li"),$l=r("Has most of ES6 functionality already implemented but it is not fully spec compliant yet."),gl=c(),V=l("li"),wl=r("No concurrent execution inside a single handler (aka. no "),Nt=l("code"),kl=r("setTimeout"),xl=r("/"),Ft=l("code"),Sl=r("setInterval"),Cl=r(")."),Dl=c(),Le=l("li"),Il=r(`Wrapped Go structural types (such as maps, slices) comes with some peculiarities and do not behave the
        exact same way as native ECMAScript values (for more details see
        `),ne=l("a"),Pl=r("goja ToValue"),Al=r(")."),jl=c(),k=l("li"),Ol=r("In relation to the above, DB "),Wt=l("code"),Tl=r("json"),Jl=r(" field values require the use of "),Ht=l("code"),Ll=r("get()"),Bl=r(` and
        `),Yt=l("code"),Rl=r("set()"),Ml=r(" helpers ("),Ut=l("em"),Gl=r("this may change in the future"),ql=r(")."),this.h()},l(e){v(R.$$.fragment,e),Qt=f(e),v(fe.$$.fragment,e),Zt=f(e),N=s(e,"P",{});var i=n(N);Qo=a(i,"The prebuilt PocketBase v0.17+ executable comes with embedded ES5 JavaScript engine ("),F=s(i,"A",{href:!0,target:!0,rel:!0});var Wl=n(F);Zo=a(Wl,"goja"),Wl.forEach(o),er=a(i,") which enables you to write custom server-side code using plain JavaScript."),i.forEach(o),eo=f(e),P=s(e,"P",{});var Qe=n(P);tr=a(Qe,"You can start by creating "),lt=s(Qe,"CODE",{});var Hl=n(lt);or=a(Hl,"*.pb.js"),Hl.forEach(o),rr=a(Qe," file(s) inside a "),st=s(Qe,"CODE",{});var Yl=n(st);ar=a(Yl,"pb_hooks"),Yl.forEach(o),lr=a(Qe,`
    directory next to your executable.`),Qe.forEach(o),to=f(e),v(pe.$$.fragment,e),oo=f(e),Be=s(e,"P",{});var Ul=n(Be);M=s(Ul,"EM",{});var Ze=n(M);sr=a(Ze,"For convenience, when making changes to the files inside "),nt=s(Ze,"CODE",{});var Xl=n(nt);nr=a(Xl,"pb_hooks"),Xl.forEach(o),ir=a(Ze,`, the process will
        automatically restart/reload itself (currently supported only on UNIX based platforms). The
        `),it=s(Ze,"CODE",{});var Kl=n(it);dr=a(Kl,"*.pb.js"),Kl.forEach(o),cr=a(Ze," files are loaded per their filename sort order."),Ze.forEach(o),Ul.forEach(o),ro=f(e),W=s(e,"P",{});var Go=n(W);fr=a(Go,"For most parts, the JavaScript APIs are derived from "),Re=s(Go,"A",{href:!0});var Ql=n(Re);pr=a(Ql,"Go"),Ql.forEach(o),mr=a(Go," with 2 main differences:"),Go.forEach(o),ao=f(e),H=s(e,"UL",{});var qo=n(H);I=s(qo,"LI",{});var ie=n(I);ur=a(ie,`Go exported method and field names are converted to camelCase, for example:
        `),hr=s(ie,"BR",{}),vr=f(ie),dt=s(ie,"CODE",{});var Zl=n(dt);br=a(Zl,'app.Dao().FindRecordById("example", "RECORD_ID")'),Zl.forEach(o),_r=a(ie,` becomes
        `),ct=s(ie,"CODE",{});var es=n(ct);Er=a(es,'$app.dao().findRecordById("example", "RECORD_ID")'),es.forEach(o),yr=a(ie,"."),ie.forEach(o),$r=f(qo),ft=s(qo,"LI",{});var ts=n(ft);gr=a(ts,"Errors are thrown as regular JavaScript exceptions and not returned as Go values."),ts.forEach(o),qo.forEach(o),lo=f(e),v(me.$$.fragment,e),so=f(e),Me=s(e,"P",{});var os=n(Me);wr=a(os,"Below is a list with some of the commonly used global objects that are accessible from everywhere:"),os.forEach(o),no=f(e),m=s(e,"UL",{});var C=n(m);Y=s(C,"LI",{});var Xt=n(Y);ue=s(Xt,"A",{href:!0,target:!0});var rs=n(ue);pt=s(rs,"CODE",{});var as=n(pt);kr=a(as,"__hooks"),as.forEach(o),rs.forEach(o),xr=a(Xt,`
        - The absolute path to the app `),mt=s(Xt,"CODE",{});var ls=n(mt);Sr=a(ls,"pb_hooks"),ls.forEach(o),Cr=a(Xt," directory."),Xt.forEach(o),Dr=f(C),Ge=s(C,"LI",{});var Vl=n(Ge);he=s(Vl,"A",{href:!0,target:!0});var ss=n(he);ut=s(ss,"CODE",{});var ns=n(ut);Ir=a(ns,"$app"),ns.forEach(o),ss.forEach(o),Pr=a(Vl," - The current running PocketBase application instance."),Vl.forEach(o),Ar=f(C),qe=s(C,"LI",{});var zl=n(qe);ve=s(zl,"A",{href:!0,target:!0});var is=n(ve);ht=s(is,"CODE",{});var ds=n(ht);jr=a(ds,"$apis.*"),ds.forEach(o),is.forEach(o),Or=a(zl," - API routing helpers and middlewares."),zl.forEach(o),Tr=f(C),Ve=s(C,"LI",{});var Nl=n(Ve);be=s(Nl,"A",{href:!0,target:!0});var cs=n(be);vt=s(cs,"CODE",{});var fs=n(vt);Jr=a(fs,"$os.*"),fs.forEach(o),cs.forEach(o),Lr=a(Nl," - OS level primitives (deleting directories, executing shell commands, etc.)."),Nl.forEach(o),Br=f(C),ze=s(C,"LI",{});var Fl=n(ze);_e=s(Fl,"A",{href:!0,target:!0});var ps=n(_e);bt=s(ps,"CODE",{});var ms=n(bt);Rr=a(ms,"$security.*"),ms.forEach(o),ps.forEach(o),Mr=a(Fl," - Low level helpers for creating and parsing JWTs, random string generation, AES encryption, etc."),Fl.forEach(o),Gr=f(C),U=s(C,"LI",{class:!0});var Vo=n(U);qr=a(Vo,`And many more - for all exposed APIs, please refer to the
        `),Ee=s(Vo,"A",{href:!0,target:!0});var us=n(Ee);Vr=a(us,"JSVM reference docs"),us.forEach(o),zr=a(Vo,"."),Vo.forEach(o),C.forEach(o),io=f(e),v(ye.$$.fragment,e),co=f(e),x=s(e,"P",{});var de=n(x);Nr=a(de,"While you can't use directly TypeScript ("),_t=s(de,"EM",{});var hs=n(_t);Fr=a(hs,"without transpiling it to JS on your own"),hs.forEach(o),Wr=a(de,`), PocketBase
    comes with builtin `),Et=s(de,"STRONG",{});var vs=n(Et);Hr=a(vs,"ambient TypeScript declarations"),vs.forEach(o),Yr=a(de,` that can help providing information
    and documentation about the available global variables, methods and arguments, code completion, etc. as
    long as your editor has TypeScript LSP support
    `),yt=s(de,"EM",{});var bs=n(yt);Ur=a(bs,"(most editors either have it builtin or available as plugin)"),bs.forEach(o),Xr=a(de,"."),de.forEach(o),fo=f(e),A=s(e,"P",{});var et=n(A);Kr=a(et,`The types declarations are stored in
    `),$t=s(et,"CODE",{});var _s=n($t);Qr=a(_s,"pb_data/types.d.ts"),_s.forEach(o),Zr=a(et,` file. You can point to those declarations using the
    `),X=s(et,"A",{href:!0,target:!0,rel:!0});var Es=n(X);ea=a(Es,"reference tripple-slash directive"),Es.forEach(o),ta=a(et,`
    at the top of your JS file:`),et.forEach(o),po=f(e),v($e.$$.fragment,e),mo=f(e),K=s(e,"P",{});var zo=n(K);oa=a(zo,`If after referencing the types your editor still doesn't perform linting, then you can try to rename your
    file to have `),gt=s(zo,"CODE",{});var ys=n(gt);ra=a(ys,".pb.ts"),ys.forEach(o),aa=a(zo," extension."),zo.forEach(o),uo=f(e),v(ge.$$.fragment,e),ho=f(e),v(we.$$.fragment,e),vo=f(e),Q=s(e,"P",{});var No=n(Q);la=a(No,`Each handler function (hook, route, middleware, etc.) is
    `),wt=s(No,"STRONG",{});var $s=n(wt);sa=a($s,'serialized and executed in its own isolated context as a separate "program"'),$s.forEach(o),na=a(No,`. This means
    that you don't have access to custom variables and functions declared outside of the handler scope. For
    example, the below code will fail:`),No.forEach(o),bo=f(e),v(ke.$$.fragment,e),_o=f(e),xe=s(e,"P",{class:!0});var gs=n(xe);ia=a(gs,`The above serialization and isolation context is also the reason why error stack trace line numbers may
    not be accurate.`),gs.forEach(o),Eo=f(e),Z=s(e,"P",{});var Fo=n(Z);da=a(Fo,`One possible workaround for sharing/reusing code across different handlers could be to move and export the
    reusable code portion as local module and load it with `),kt=s(Fo,"CODE",{});var ws=n(kt);ca=a(ws,"require()"),ws.forEach(o),fa=a(Fo,` inside the handler but keep in
    mind that the loaded modules use a shared registry and mutations should be avoided when possible to prevent
    concurrency issues:`),Fo.forEach(o),yo=f(e),v(Se.$$.fragment,e),$o=f(e),v(Ce.$$.fragment,e),go=f(e),$=s(e,"P",{});var T=n($);pa=a(T,`Relative file paths are relative to the current working directory (CWD) and not to the
    `),xt=s(T,"CODE",{});var ks=n(xt);ma=a(ks,"pb_hooks"),ks.forEach(o),ua=a(T,`.
    `),ha=s(T,"BR",{}),va=a(T,`
    To get an absolute path to the `),St=s(T,"CODE",{});var xs=n(St);ba=a(xs,"pb_hooks"),xs.forEach(o),_a=a(T,` directory you can use the global
    `),Ne=s(T,"CODE",{class:!0});var Ss=n(Ne);Ea=a(Ss,"__hooks"),Ss.forEach(o),ya=a(T," variable."),T.forEach(o),wo=f(e),v(De.$$.fragment,e),ko=f(e),G=s(e,"DIV",{class:!0});var Wo=n(G);Fe=s(Wo,"DIV",{class:!0});var Cs=n(Fe);Ct=s(Cs,"I",{class:!0}),n(Ct).forEach(o),Cs.forEach(o),$a=f(Wo),We=s(Wo,"DIV",{class:!0});var Ds=n(We);w=s(Ds,"P",{});var J=n(w);ga=a(J,`Please note that the embedded JavaScript engine is not a Node.js or browser environment, meaning
            that modules that relies on APIs like `),Dt=s(J,"EM",{});var Is=n(Dt);wa=a(Is,"window"),Is.forEach(o),ka=a(J,", "),It=s(J,"EM",{});var Ps=n(It);xa=a(Ps,"fs"),Ps.forEach(o),Sa=a(J,`,
            `),Pt=s(J,"EM",{});var As=n(Pt);Ca=a(As,"fetch"),As.forEach(o),Da=a(J,", "),At=s(J,"EM",{});var js=n(At);Ia=a(js,"buffer"),js.forEach(o),Pa=a(J,` or any other runtime specific API not part of the ES5 spec may not
            work!`),J.forEach(o),Ds.forEach(o),Wo.forEach(o),xo=f(e),He=s(e,"P",{});var Os=n(He);Aa=a(Os,`You can load modules either by specifying their local filesystem path or by using their name, which will
    automatically search in:`),Os.forEach(o),So=f(e),j=s(e,"UL",{});var tt=n(j);Ie=s(tt,"LI",{});var Ho=n(Ie);ja=a(Ho,"the current working directory ("),jt=s(Ho,"EM",{});var Ts=n(jt);Oa=a(Ts,"affects also relative paths"),Ts.forEach(o),Ta=a(Ho,")"),Ho.forEach(o),Ja=f(tt),Pe=s(tt,"LI",{});var Yo=n(Pe);La=a(Yo,"any "),Ot=s(Yo,"CODE",{});var Js=n(Ot);Ba=a(Js,"node_modules"),Js.forEach(o),Ra=a(Yo," directory"),Yo.forEach(o),Ma=f(tt),ee=s(tt,"LI",{});var Kt=n(ee);Ga=a(Kt,"any parent "),Tt=s(Kt,"CODE",{});var Ls=n(Tt);qa=a(Ls,"node_modules"),Ls.forEach(o),Va=a(Kt," directory, up to the closest "),Jt=s(Kt,"CODE",{});var Bs=n(Jt);za=a(Bs,"package.json"),Bs.forEach(o),Kt.forEach(o),tt.forEach(o),Co=f(e),u=s(e,"P",{});var D=n(u);Na=a(D,`Currently only CommonJS (CJS) modules are supported and can be loaded with
    `),Lt=s(D,"CODE",{});var Rs=n(Lt);Fa=a(Rs,"const x = require(...)"),Rs.forEach(o),Wa=a(D,`.
    `),Ha=s(D,"BR",{}),Ya=a(D,`
    ECMAScript modules (ESM) can be loaded by first precompiling and transforming your dependencies with a bundler
    like
    `),te=s(D,"A",{href:!0,target:!0,rel:!0});var Ms=n(te);Ua=a(Ms,"rollup"),Ms.forEach(o),Xa=a(D,`,
    `),oe=s(D,"A",{href:!0,target:!0,rel:!0});var Gs=n(oe);Ka=a(Gs,"webpack"),Gs.forEach(o),Qa=a(D,`,
    `),re=s(D,"A",{href:!0,target:!0,rel:!0});var qs=n(re);Za=a(qs,"browserify"),qs.forEach(o),el=a(D,", etc."),D.forEach(o),Do=f(e),Ye=s(e,"P",{});var Vs=n(Ye);tl=a(Vs,"A common usage of local modules is for loading shared helpers or configuration parameters, for example:"),Vs.forEach(o),Io=f(e),v(Ae.$$.fragment,e),Po=f(e),Ue=s(e,"DIV",{class:!0}),n(Ue).forEach(o),Ao=f(e),v(je.$$.fragment,e),jo=f(e),q=s(e,"DIV",{class:!0});var Uo=n(q);Xe=s(Uo,"DIV",{class:!0});var zs=n(Xe);Bt=s(zs,"I",{class:!0}),n(Bt).forEach(o),zs.forEach(o),ol=f(Uo),Ke=s(Uo,"DIV",{class:!0});var Ns=n(Ke);Rt=s(Ns,"P",{});var Fs=n(Rt);rl=a(Fs,`Loaded modules use a shared registry and mutations should be avoided when possible to prevent
            concurrency issues.`),Fs.forEach(o),Ns.forEach(o),Uo.forEach(o),Oo=f(e),v(Oe.$$.fragment,e),To=f(e),g=s(e,"P",{});var L=n(g);al=a(L,"The prebuilt executable comes with a "),Mt=s(L,"STRONG",{});var Ws=n(Mt);ll=a(Ws,"prewarmed pool of 25 JS runtimes"),Ws.forEach(o),sl=a(L,`, which helps
    maintaining the handlers execution times on par with the Go equivalent code (see
    `),ae=s(L,"A",{href:!0,target:!0,rel:!0});var Hs=n(ae);nl=a(Hs,"benchmarks"),Hs.forEach(o),il=a(L,"). You can adjust the pool size manually with the "),Gt=s(L,"CODE",{});var Ys=n(Gt);dl=a(Ys,"--hooksPool=100"),Ys.forEach(o),cl=a(L," flag ("),qt=s(L,"EM",{});var Us=n(qt);fl=a(Us,`increasing the pool size may improve the performance in high concurrent scenarios but also will
        increase the memory usage`),Us.forEach(o),pl=a(L,")."),L.forEach(o),Jo=f(e),O=s(e,"P",{});var ot=n(O);ml=a(ot,`Note that the handlers performance may degrade if you have heavy computational tasks in pure JavaScript
    (eg. encryption, random generators, etc.). For such cases prefer using the exposed `),Te=s(ot,"A",{href:!0,target:!0});var Xs=n(Te);ul=a(Xs,"Go bindings"),Xs.forEach(o),hl=a(ot,`
    (eg. `),Vt=s(ot,"CODE",{});var Ks=n(Vt);vl=a(Ks,"$security.randomString(10)"),Ks.forEach(o),bl=a(ot,")."),ot.forEach(o),Lo=f(e),v(Je.$$.fragment,e),Bo=f(e),le=s(e,"P",{});var Xo=n(le);_l=a(Xo,`We inherit some of the limitations and caveats of the embedded JavaScript engine
    
    (`),se=s(Xo,"A",{href:!0,target:!0,rel:!0});var Qs=n(se);El=a(Qs,"goja"),Qs.forEach(o),yl=a(Xo,"):"),Xo.forEach(o),Ro=f(e),S=s(e,"UL",{});var ce=n(S);zt=s(ce,"LI",{});var Zs=n(zt);$l=a(Zs,"Has most of ES6 functionality already implemented but it is not fully spec compliant yet."),Zs.forEach(o),gl=f(ce),V=s(ce,"LI",{});var rt=n(V);wl=a(rt,"No concurrent execution inside a single handler (aka. no "),Nt=s(rt,"CODE",{});var en=n(Nt);kl=a(en,"setTimeout"),en.forEach(o),xl=a(rt,"/"),Ft=s(rt,"CODE",{});var tn=n(Ft);Sl=a(tn,"setInterval"),tn.forEach(o),Cl=a(rt,")."),rt.forEach(o),Dl=f(ce),Le=s(ce,"LI",{});var Ko=n(Le);Il=a(Ko,`Wrapped Go structural types (such as maps, slices) comes with some peculiarities and do not behave the
        exact same way as native ECMAScript values (for more details see
        `),ne=s(Ko,"A",{href:!0,target:!0,rel:!0});var on=n(ne);Pl=a(on,"goja ToValue"),on.forEach(o),Al=a(Ko,")."),Ko.forEach(o),jl=f(ce),k=s(ce,"LI",{});var B=n(k);Ol=a(B,"In relation to the above, DB "),Wt=s(B,"CODE",{});var rn=n(Wt);Tl=a(rn,"json"),rn.forEach(o),Jl=a(B," field values require the use of "),Ht=s(B,"CODE",{});var an=n(Ht);Ll=a(an,"get()"),an.forEach(o),Bl=a(B,` and
        `),Yt=s(B,"CODE",{});var ln=n(Yt);Rl=a(ln,"set()"),ln.forEach(o),Ml=a(B," helpers ("),Ut=s(B,"EM",{});var sn=n(Ut);Gl=a(sn,"this may change in the future"),sn.forEach(o),ql=a(B,")."),B.forEach(o),ce.forEach(o),this.h()},h(){p(F,"href","https://github.com/dop251/goja"),p(F,"target","_blank"),p(F,"rel","nopppener noreferrer"),p(Re,"href","/docs/go-overview"),p(ue,"href","/jsvm/variables/__hooks.html"),p(ue,"target","_blank"),p(he,"href","/jsvm/modules/_app.html"),p(he,"target","_blank"),p(ve,"href","/jsvm/modules/_apis.html"),p(ve,"target","_blank"),p(be,"href","/jsvm/modules/_os.html"),p(be,"target","_blank"),p(_e,"href","/jsvm/modules/_security.html"),p(_e,"target","_blank"),p(Ee,"href","/jsvm/index.html"),p(Ee,"target","_blank"),p(U,"class","txt-bold"),p(X,"href","https://www.typescriptlang.org/docs/handbook/triple-slash-directives.html#-reference-path-"),p(X,"target","_blank"),p(X,"rel","noopener"),p(xe,"class","txt-hint txt-italic"),p(Ne,"class","txt-bold"),p(Ct,"class","ri-alert-line"),p(Fe,"class","icon"),p(We,"class","content"),p(G,"class","alert alert-danger m-b-sm"),p(te,"href","https://rollupjs.org/"),p(te,"target","_blank"),p(te,"rel","noopener noreferrer"),p(oe,"href","https://webpack.js.org/"),p(oe,"target","_blank"),p(oe,"rel","noopener noreferrer"),p(re,"href","https://browserify.org/"),p(re,"target","_blank"),p(re,"rel","noopener noreferrer"),p(Ue,"class","clearfix m-b-10"),p(Bt,"class","ri-information-line"),p(Xe,"class","icon"),p(Ke,"class","content"),p(q,"class","alert alert-info m-t-10 m-b-sm"),p(ae,"href","https://github.com/pocketbase/benchmarks/blob/master/results/hetzner_cax11.md#go-vs-js-route-execution"),p(ae,"target","blank"),p(ae,"rel","noopener noreferrer"),p(Te,"href","/jsvm/index.html"),p(Te,"target","_blank"),p(se,"href","https://github.com/dop251/goja"),p(se,"target","_blank"),p(se,"rel","nopppener noreferrer"),p(ne,"href","https://pkg.go.dev/github.com/dop251/goja#Runtime.ToValue"),p(ne,"target","blank"),p(ne,"rel","noreferrer noopener")},m(e,i){b(R,e,i),d(e,Qt,i),b(fe,e,i),d(e,Zt,i),d(e,N,i),t(N,Qo),t(N,F),t(F,Zo),t(N,er),d(e,eo,i),d(e,P,i),t(P,tr),t(P,lt),t(lt,or),t(P,rr),t(P,st),t(st,ar),t(P,lr),d(e,to,i),b(pe,e,i),d(e,oo,i),d(e,Be,i),t(Be,M),t(M,sr),t(M,nt),t(nt,nr),t(M,ir),t(M,it),t(it,dr),t(M,cr),d(e,ro,i),d(e,W,i),t(W,fr),t(W,Re),t(Re,pr),t(W,mr),d(e,ao,i),d(e,H,i),t(H,I),t(I,ur),t(I,hr),t(I,vr),t(I,dt),t(dt,br),t(I,_r),t(I,ct),t(ct,Er),t(I,yr),t(H,$r),t(H,ft),t(ft,gr),d(e,lo,i),b(me,e,i),d(e,so,i),d(e,Me,i),t(Me,wr),d(e,no,i),d(e,m,i),t(m,Y),t(Y,ue),t(ue,pt),t(pt,kr),t(Y,xr),t(Y,mt),t(mt,Sr),t(Y,Cr),t(m,Dr),t(m,Ge),t(Ge,he),t(he,ut),t(ut,Ir),t(Ge,Pr),t(m,Ar),t(m,qe),t(qe,ve),t(ve,ht),t(ht,jr),t(qe,Or),t(m,Tr),t(m,Ve),t(Ve,be),t(be,vt),t(vt,Jr),t(Ve,Lr),t(m,Br),t(m,ze),t(ze,_e),t(_e,bt),t(bt,Rr),t(ze,Mr),t(m,Gr),t(m,U),t(U,qr),t(U,Ee),t(Ee,Vr),t(U,zr),d(e,io,i),b(ye,e,i),d(e,co,i),d(e,x,i),t(x,Nr),t(x,_t),t(_t,Fr),t(x,Wr),t(x,Et),t(Et,Hr),t(x,Yr),t(x,yt),t(yt,Ur),t(x,Xr),d(e,fo,i),d(e,A,i),t(A,Kr),t(A,$t),t($t,Qr),t(A,Zr),t(A,X),t(X,ea),t(A,ta),d(e,po,i),b($e,e,i),d(e,mo,i),d(e,K,i),t(K,oa),t(K,gt),t(gt,ra),t(K,aa),d(e,uo,i),b(ge,e,i),d(e,ho,i),b(we,e,i),d(e,vo,i),d(e,Q,i),t(Q,la),t(Q,wt),t(wt,sa),t(Q,na),d(e,bo,i),b(ke,e,i),d(e,_o,i),d(e,xe,i),t(xe,ia),d(e,Eo,i),d(e,Z,i),t(Z,da),t(Z,kt),t(kt,ca),t(Z,fa),d(e,yo,i),b(Se,e,i),d(e,$o,i),b(Ce,e,i),d(e,go,i),d(e,$,i),t($,pa),t($,xt),t(xt,ma),t($,ua),t($,ha),t($,va),t($,St),t(St,ba),t($,_a),t($,Ne),t(Ne,Ea),t($,ya),d(e,wo,i),b(De,e,i),d(e,ko,i),d(e,G,i),t(G,Fe),t(Fe,Ct),t(G,$a),t(G,We),t(We,w),t(w,ga),t(w,Dt),t(Dt,wa),t(w,ka),t(w,It),t(It,xa),t(w,Sa),t(w,Pt),t(Pt,Ca),t(w,Da),t(w,At),t(At,Ia),t(w,Pa),d(e,xo,i),d(e,He,i),t(He,Aa),d(e,So,i),d(e,j,i),t(j,Ie),t(Ie,ja),t(Ie,jt),t(jt,Oa),t(Ie,Ta),t(j,Ja),t(j,Pe),t(Pe,La),t(Pe,Ot),t(Ot,Ba),t(Pe,Ra),t(j,Ma),t(j,ee),t(ee,Ga),t(ee,Tt),t(Tt,qa),t(ee,Va),t(ee,Jt),t(Jt,za),d(e,Co,i),d(e,u,i),t(u,Na),t(u,Lt),t(Lt,Fa),t(u,Wa),t(u,Ha),t(u,Ya),t(u,te),t(te,Ua),t(u,Xa),t(u,oe),t(oe,Ka),t(u,Qa),t(u,re),t(re,Za),t(u,el),d(e,Do,i),d(e,Ye,i),t(Ye,tl),d(e,Io,i),b(Ae,e,i),d(e,Po,i),d(e,Ue,i),d(e,Ao,i),b(je,e,i),d(e,jo,i),d(e,q,i),t(q,Xe),t(Xe,Bt),t(q,ol),t(q,Ke),t(Ke,Rt),t(Rt,rl),d(e,Oo,i),b(Oe,e,i),d(e,To,i),d(e,g,i),t(g,al),t(g,Mt),t(Mt,ll),t(g,sl),t(g,ae),t(ae,nl),t(g,il),t(g,Gt),t(Gt,dl),t(g,cl),t(g,qt),t(qt,fl),t(g,pl),d(e,Jo,i),d(e,O,i),t(O,ml),t(O,Te),t(Te,ul),t(O,hl),t(O,Vt),t(Vt,vl),t(O,bl),d(e,Lo,i),b(Je,e,i),d(e,Bo,i),d(e,le,i),t(le,_l),t(le,se),t(se,El),t(le,yl),d(e,Ro,i),d(e,S,i),t(S,zt),t(zt,$l),t(S,gl),t(S,V),t(V,wl),t(V,Nt),t(Nt,kl),t(V,xl),t(V,Ft),t(Ft,Sl),t(V,Cl),t(S,Dl),t(S,Le),t(Le,Il),t(Le,ne),t(ne,Pl),t(Le,Al),t(S,jl),t(S,k),t(k,Ol),t(k,Wt),t(Wt,Tl),t(k,Jl),t(k,Ht),t(Ht,Ll),t(k,Bl),t(k,Yt),t(Yt,Rl),t(k,Ml),t(k,Ut),t(Ut,Gl),t(k,ql),Mo=!0},p:pn,i(e){Mo||(_(R.$$.fragment,e),_(fe.$$.fragment,e),_(pe.$$.fragment,e),_(me.$$.fragment,e),_(ye.$$.fragment,e),_($e.$$.fragment,e),_(ge.$$.fragment,e),_(we.$$.fragment,e),_(ke.$$.fragment,e),_(Se.$$.fragment,e),_(Ce.$$.fragment,e),_(De.$$.fragment,e),_(Ae.$$.fragment,e),_(je.$$.fragment,e),_(Oe.$$.fragment,e),_(Je.$$.fragment,e),Mo=!0)},o(e){E(R.$$.fragment,e),E(fe.$$.fragment,e),E(pe.$$.fragment,e),E(me.$$.fragment,e),E(ye.$$.fragment,e),E($e.$$.fragment,e),E(ge.$$.fragment,e),E(we.$$.fragment,e),E(ke.$$.fragment,e),E(Se.$$.fragment,e),E(Ce.$$.fragment,e),E(De.$$.fragment,e),E(Ae.$$.fragment,e),E(je.$$.fragment,e),E(Oe.$$.fragment,e),E(Je.$$.fragment,e),Mo=!1},d(e){y(R,e),e&&o(Qt),y(fe,e),e&&o(Zt),e&&o(N),e&&o(eo),e&&o(P),e&&o(to),y(pe,e),e&&o(oo),e&&o(Be),e&&o(ro),e&&o(W),e&&o(ao),e&&o(H),e&&o(lo),y(me,e),e&&o(so),e&&o(Me),e&&o(no),e&&o(m),e&&o(io),y(ye,e),e&&o(co),e&&o(x),e&&o(fo),e&&o(A),e&&o(po),y($e,e),e&&o(mo),e&&o(K),e&&o(uo),y(ge,e),e&&o(ho),y(we,e),e&&o(vo),e&&o(Q),e&&o(bo),y(ke,e),e&&o(_o),e&&o(xe),e&&o(Eo),e&&o(Z),e&&o(yo),y(Se,e),e&&o($o),y(Ce,e),e&&o(go),e&&o($),e&&o(wo),y(De,e),e&&o(ko),e&&o(G),e&&o(xo),e&&o(He),e&&o(So),e&&o(j),e&&o(Co),e&&o(u),e&&o(Do),e&&o(Ye),e&&o(Io),y(Ae,e),e&&o(Po),e&&o(Ue),e&&o(Ao),y(je,e),e&&o(jo),e&&o(q),e&&o(Oo),y(Oe,e),e&&o(To),e&&o(g),e&&o(Jo),e&&o(O),e&&o(Lo),y(Je,e),e&&o(Bo),e&&o(le),e&&o(Ro),e&&o(S)}}}class En extends dn{constructor(R){super(),cn(this,R,null,un,fn,{})}}export{En as component};
