<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from pocketbase.io/docs/js-overview by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 26 Jun 2024 08:32:20 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Primary Meta Tags -->
    <meta name="description" content="Open Source backend in 1 file with realtime database, authentication, file storage and admin dashboard">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="PocketBase - Open Source backend in 1 file">
    <meta property="og:description" content="Open Source backend in 1 file with realtime database, authentication, file storage and admin dashboard">
    <meta property="og:image" content="../images/og.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="PocketBase - Open Source backend in 1 file">
    <meta property="twitter:description" content="Open Source backend in 1 file with realtime database, authentication, file storage and admin dashboard">
    <meta property="twitter:image" content="../images/og.png">

    <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="../images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../images/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://pocketbase.io/images/favicon/site.webmanifest">
    <link rel="mask-icon" href="https://pocketbase.io/images/favicon/safari-pinned-tab.svg" color="#000000">
    <link rel="shortcut icon" href="https://pocketbase.io/images/favicon/favicon.ico">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-config" content="https://pocketbase.io/images/favicon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <!-- preload -->
    <link rel="preload" href="https://pocketbase.io/fonts/source-sans-pro/source-sans-pro-v18-latin_cyrillic-regular.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://pocketbase.io/fonts/source-sans-pro/source-sans-pro-v18-latin_cyrillic-600.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://pocketbase.io/fonts/source-sans-pro/source-sans-pro-v18-latin_cyrillic-700.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://pocketbase.io/fonts/source-sans-pro/source-sans-pro-v18-latin_cyrillic-italic.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://pocketbase.io/fonts/ubuntu-mono/ubuntu-mono-v17-cyrillic_latin-regular.woff2" as="font" type="font/woff2" crossorigin>

    <script>
        // CSS3 animations support check
        (function () {
            if (typeof document === "undefined") {
                return; // serverside rendering
            }

            let elem = document.createElement("div");
            let hasAnimation = elem.style.animationName !== undefined;

            if (!hasAnimation) {
                document.documentElement.classList.add("no-animations");
            }
        })();
    </script>

    <script>
        // silent svelte console errors
        if (typeof window === "undefined") {
            window = {};
        }
        window.Prism = window.Prism || {};
        window.Prism.manual = true;

        if (typeof navigator !== "undefined" && navigator.userAgentData) {
            navigator.userAgentData.getHighEntropyValues([
                "architecture",
            ]).then((ua) => {
                window.UA_ARCHITECTURE = ua.architecture
            });
        }
    </script>

    
		<link href="../_app/immutable/assets/2.0975cac3.css" rel="stylesheet">
		<link href="../_app/immutable/assets/main.a2ec6d35.css" rel="stylesheet">
		<link href="../_app/immutable/assets/3.9c47a874.css" rel="stylesheet">
		<link href="../_app/immutable/assets/CodeBlock.d22afb3e.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.c884ba35.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.a7566c1a.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/singletons.01dc88c8.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.f5b995db.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.7b6d4e54.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.1674d90f.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/2.d9b2382e.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/PageFooter.186a253e.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/tooltip.f1d7ab7e.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CommonHelper.7329e1a7.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/3.a42e91c2.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/stores.fb1f6c95.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preferences.0fc33f39.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/42.17638da1.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/HeadingLink.20322812.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Toc.c31a36b6.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CodeBlock.a090ee9b.js"><title>Extend with JavaScript - Overview - Docs - PocketBase</title><!-- HEAD_svelte-q27gla_START --><!-- HEAD_svelte-q27gla_END -->
</head>
<body>
    <div class="page-body">



<header class="page-header"><div class="wrapper wrapper-lg"><a href="https://pocketbase.io/" class="logo logo-sm"><img src="https://pocketbase.io/images/logo.svg" alt="PocketBase logo" width="40" height="40">
            <span class="txt">Pocket<strong>Base</strong></span>
            <span class="version">v0.22.14</span></a>

        <div class="flex-fill"></div>

        
        

        

        <button type="button" class="btn btn-circle btn-secondary responsive-menu-btn" title="Menu"><span></span>
            <i class="ri-menu-3-fill"></i>
            

<div class="toggler-container"></div></button>

        <nav class="main-menu"><a href="https://pocketbase.io/faq" class="btn btn-secondary">FAQ</a>
            <a href="https://github.com/pocketbase/pocketbase/discussions" class="btn btn-secondary" target="_blank" rel="noreferrer noopener">Discussions
            </a>
            <a href="https://github.com/pocketbase/pocketbase" class="btn btn-circle btn-secondary" target="_blank" rel="noreferrer noopener" title="GitHub Repo"><i class="ri-github-line"></i></a>
            <a href="https://pocketbase.io/docs" class="btn btn-outline btn-expanded"><span class="txt">Documentation</span></a></nav></div></header>

<main class="wrapper wrapper-lg page-content-wrapper">

<aside class="page-sidebar highlight docs-sidebar"><div class="sticky-wrapper svelte-1izh69t"><div class="absolute-wrapper svelte-1izh69t"><div class="sidebar-content svelte-1izh69t"><nav class="sidebar-list">
        
        <a href="https://pocketbase.io/docs" class="list-item">
            <span class="icon"><i class="ri-home-2-line"></i></span>
            <span class="txt">Introduction</span>
            </a>
        
        
        <a href="collections.html" class="list-item">
            <span class="icon"><i class="ri-database-2-line"></i></span>
            <span class="txt">Collections</span>
            </a>
        
        
        <a href="api-rules-and-filters.html" class="list-item">
            <span class="icon"><i class="ri-shield-check-line"></i></span>
            <span class="txt">API rules and filters</span>
            </a>
        
        
        <a href="client-side-sdks.html" class="list-item">
            <span class="icon"><i class="ri-tools-line"></i></span>
            <span class="txt">Client-side SDKs</span>
            </a>
        
        
        <a href="authentication.html" class="list-item">
            <span class="icon"><i class="ri-group-line"></i></span>
            <span class="txt">Authentication</span>
            </a>
        
        
        <a href="files-handling.html" class="list-item">
            <span class="icon"><i class="ri-upload-cloud-line"></i></span>
            <span class="txt">Files upload and handling</span>
            </a>
        
        
        <a href="working-with-relations.html" class="list-item">
            <span class="icon"><i class="ri-mind-map"></i></span>
            <span class="txt">Working with relations</span>
            </a>
        
        
        <a href="use-as-framework.html" class="list-item">
            <span class="icon"><i class="ri-code-s-slash-line"></i></span>
            <span class="txt">Use as framework</span>
            </a>
        
        
        <a href="api-records.html" class="list-item">
            <span class="icon"><i class="ri-file-list-2-line"></i></span>
            <span class="txt">Web APIs reference</span>
            </a>
        
        
        <a href="going-to-production.html" class="list-item">
            <span class="icon"><i class="ri-check-double-line"></i></span>
            <span class="txt">Going to production</span>
            </a>
        </nav>

                <div class="clearfix m-t-base"></div>

                <div class="sidebar-bg-section"><div class="tabs-header stretched compact"><a class="tab-item" href="go-overview.html"><div class="block">Extend with
                                <br>
                                <strong>Go</strong></div></a>
                        <a class="tab-item active" href="js-overview.html"><div class="block">Extend with
                                <br>
                                <strong>JavaScript</strong></div></a></div>
                    <div class="tabs-content"><div class="tab-item"><nav class="sidebar-list">
        
        <a href="go-overview.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Overview</span>
            </a>
        
        
        <a href="go-event-hooks.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Event hooks</span>
            </a>
        
        
        <a href="go-routing.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Routing</span>
            </a>
        
        
        <a href="go-database.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Database</span>
            </a>
        
        
        <a href="go-records.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Record operations</span>
            </a>
        
        
        <a href="go-collections.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Collection operations</span>
            </a>
        
        
        <a href="go-migrations.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Migrations</span>
            </a>
        
        
        <a href="go-jobs-scheduling.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Jobs scheduling</span>
            </a>
        
        
        <a href="go-console-commands.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Console commands</span>
            </a>
        
        
        <a href="go-sending-emails.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Sending emails</span>
            </a>
        
        
        <a href="go-rendering-templates.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Rendering templates</span>
            </a>
        
        
        <a href="go-logging.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Logging</span>
            </a>
        
        
        <a href="go-testing.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Testing</span>
            </a>
        
        
        <a href="go-custom-models.html" class="list-item"><span class="label label-sm label-info svelte-1izh69t">Go</span>
            
            <span class="txt">Custom models</span>
            </a>
        </nav></div>
                        <div class="tab-item active"><nav class="sidebar-list">
        
        <a href="js-overview.html" class="list-item active"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Overview</span>
            </a>
        
        
        <a href="js-event-hooks.html" class="list-item"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Event hooks</span>
            </a>
        
        
        <a href="js-routing.html" class="list-item"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Routing</span>
            </a>
        
        
        <a href="js-database.html" class="list-item"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Database</span>
            </a>
        
        
        <a href="js-records.html" class="list-item"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Record operations</span>
            </a>
        
        
        <a href="js-collections.html" class="list-item"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Collection operations</span>
            </a>
        
        
        <a href="js-migrations.html" class="list-item"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Migrations</span>
            </a>
        
        
        <a href="js-jobs-scheduling.html" class="list-item"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Jobs scheduling</span>
            </a>
        
        
        <a href="js-console-commands.html" class="list-item"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Console commands</span>
            </a>
        
        
        <a href="js-sending-emails.html" class="list-item"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Sending emails</span>
            </a>
        
        
        <a href="js-sending-http-requests.html" class="list-item"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Sending HTTP requests</span>
            </a>
        
        
        <a href="js-rendering-templates.html" class="list-item"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Rendering templates</span>
            </a>
        
        
        <a href="js-logging.html" class="list-item"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Logging</span>
            </a>
        
        
        <a href="https://pocketbase.io/jsvm/index.html" class="list-item" target="_blank" rel="noopener noreferrer"><span class="label label-sm label-warning svelte-1izh69t">JS</span>
            
            <span class="txt">Types reference</span>
            </a>
        </nav></div></div></div></div></div></div>
</aside>

<div class="page-content"><nav class="breadcrumbs"><div class="breadcrumb-item">Extend with JavaScript - Overview</div></nav>

    <div class="content"><div class="toc"><ul class="toc-list-1"></ul></div>

<h3 id="javascript-engine" class="heading-link "><a href="#javascript-engine" class="link-primary">
        JavaScript engine
        </a></h3>
<p>The prebuilt PocketBase v0.17+ executable comes with embedded ES5 JavaScript engine (<a href="https://github.com/dop251/goja" target="_blank" rel="nopppener noreferrer">goja</a>) which enables you to write custom server-side code using plain JavaScript.
</p>
<p>You can start by creating <code>*.pb.js</code> file(s) inside a <code>pb_hooks</code>
    directory next to your executable.
</p>
<div class="code-wrapper prism-light svelte-1qrji6i"><code class="svelte-1qrji6i"><!-- HTML_TAG_START --><span class="token comment">// pb_hooks/main.pb.js</span>

<span class="token function">routerAdd</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> <span class="token string">"/hello/:name"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> name <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">pathParam</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">"message"</span><span class="token operator">:</span> <span class="token string">"Hello "</span> <span class="token operator">+</span> name <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">onModelAfterUpdate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"user updated..."</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"users"</span><span class="token punctuation">)</span><!-- HTML_TAG_END --></code>
</div>
<p><em>For convenience, when making changes to the files inside <code>pb_hooks</code>, the process will
        automatically restart/reload itself (currently supported only on UNIX based platforms). The
        <code>*.pb.js</code> files are loaded per their filename sort order.
    </em></p>
<p>For most parts, the JavaScript APIs are derived from <a href="go-overview.html">Go</a> with 2 main differences:
</p>
<ul><li>Go exported method and field names are converted to camelCase, for example:
        <br>
        <code>app.Dao().FindRecordById(&quot;example&quot;, &quot;RECORD_ID&quot;)</code> becomes
        <code>$app.dao().findRecordById(&quot;example&quot;, &quot;RECORD_ID&quot;)</code>.
    </li>
    <li>Errors are thrown as regular JavaScript exceptions and not returned as Go values.</li></ul>

<h5 id="global-objects" class="heading-link "><a href="#global-objects" class="link-primary">
        Global objects
        </a></h5>
<p>Below is a list with some of the commonly used global objects that are accessible from everywhere:</p>
<ul><li><a href="https://pocketbase.io/jsvm/variables/__hooks.html" target="_blank"><code>__hooks</code></a>
        - The absolute path to the app <code>pb_hooks</code> directory.
    </li>
    <li><a href="https://pocketbase.io/jsvm/modules/_app.html" target="_blank"><code>$app</code></a> - The current running PocketBase application instance.
    </li>
    <li><a href="https://pocketbase.io/jsvm/modules/_apis.html" target="_blank"><code>$apis.*</code></a> - API routing helpers and middlewares.
    </li>
    <li><a href="https://pocketbase.io/jsvm/modules/_os.html" target="_blank"><code>$os.*</code></a> - OS level primitives (deleting directories, executing shell commands, etc.).
    </li>
    <li><a href="https://pocketbase.io/jsvm/modules/_security.html" target="_blank"><code>$security.*</code></a> - Low level helpers for creating and parsing JWTs, random string generation, AES encryption, etc.
    </li>
    <li class="txt-bold">And many more - for all exposed APIs, please refer to the
        <a href="https://pocketbase.io/jsvm/index.html" target="_blank">JSVM reference docs</a>.
    </li></ul>

<h3 id="typescript-declarations-and-code-completion" class="heading-link "><a href="#typescript-declarations-and-code-completion" class="link-primary">
        TypeScript declarations and code completion
        </a></h3>
<p>While you can&#39;t use directly TypeScript (<em>without transpiling it to JS on your own</em>), PocketBase
    comes with builtin <strong>ambient TypeScript declarations</strong> that can help providing information
    and documentation about the available global variables, methods and arguments, code completion, etc. as
    long as your editor has TypeScript LSP support
    <em>(most editors either have it builtin or available as plugin)</em>.
</p>
<p>The types declarations are stored in
    <code>pb_data/types.d.ts</code> file. You can point to those declarations using the
    <a href="https://www.typescriptlang.org/docs/handbook/triple-slash-directives.html#-reference-path-" target="_blank" rel="noopener">reference tripple-slash directive</a>
    at the top of your JS file:
</p>
<div class="code-wrapper prism-light svelte-1qrji6i"><code class="svelte-1qrji6i"><!-- HTML_TAG_START --><span class="token comment">/// &lt;reference path="../pb_data/types.d.ts" /></span>

<span class="token function">onAfterBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"App initialized!"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><!-- HTML_TAG_END --></code>
</div>
<p>If after referencing the types your editor still doesn&#39;t perform linting, then you can try to rename your
    file to have <code>.pb.ts</code> extension.
</p>

<h3 id="caveats-and-limitations" class="heading-link "><a href="#caveats-and-limitations" class="link-primary">
        Caveats and limitations
        </a></h3>

<h5 id="handlers-scope" class="heading-link "><a href="#handlers-scope" class="link-primary">
        Handlers scope
        </a></h5>
<p>Each handler function (hook, route, middleware, etc.) is
    <strong>serialized and executed in its own isolated context as a separate &quot;program&quot;</strong>. This means
    that you don&#39;t have access to custom variables and functions declared outside of the handler scope. For
    example, the below code will fail:
</p>
<div class="code-wrapper prism-light svelte-1qrji6i"><code class="svelte-1qrji6i"><!-- HTML_TAG_START --><span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">"test"</span>

<span class="token function">onAfterBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token comment">// &lt;-- name will be undefined inside the handler</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><!-- HTML_TAG_END --></code>
</div>
<p class="txt-hint txt-italic">The above serialization and isolation context is also the reason why error stack trace line numbers may
    not be accurate.
</p>
<p>One possible workaround for sharing/reusing code across different handlers could be to move and export the
    reusable code portion as local module and load it with <code>require()</code> inside the handler but keep in
    mind that the loaded modules use a shared registry and mutations should be avoided when possible to prevent
    concurrency issues:
</p>

<div class="code-wrapper prism-light svelte-1qrji6i"><code class="svelte-1qrji6i"><!-- HTML_TAG_START --><span class="token function">onAfterBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__hooks<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/config.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><!-- HTML_TAG_END --></code>
</div>

<h5 id="relative-paths" class="heading-link "><a href="#relative-paths" class="link-primary">
        Relative paths
        </a></h5>
<p>Relative file paths are relative to the current working directory (CWD) and not to the
    <code>pb_hooks</code>.
    <br>
    To get an absolute path to the <code>pb_hooks</code> directory you can use the global
    <code class="txt-bold">__hooks</code> variable.
</p>

<h5 id="loading-modules" class="heading-link "><a href="#loading-modules" class="link-primary">
        Loading modules
        </a></h5>
<div class="alert alert-danger m-b-sm"><div class="icon"><i class="ri-alert-line"></i></div>
    <div class="content"><p>Please note that the embedded JavaScript engine is not a Node.js or browser environment, meaning
            that modules that relies on APIs like <em>window</em>, <em>fs</em>,
            <em>fetch</em>, <em>buffer</em> or any other runtime specific API not part of the ES5 spec may not
            work!
        </p></div></div>
<p>You can load modules either by specifying their local filesystem path or by using their name, which will
    automatically search in:
</p>
<ul><li>the current working directory (<em>affects also relative paths</em>)</li>
    <li>any <code>node_modules</code> directory</li>
    <li>any parent <code>node_modules</code> directory, up to the closest <code>package.json</code></li></ul>
<p>Currently only CommonJS (CJS) modules are supported and can be loaded with
    <code>const x = require(...)</code>.
    <br>
    ECMAScript modules (ESM) can be loaded by first precompiling and transforming your dependencies with a bundler
    like
    <a href="https://rollupjs.org/" target="_blank" rel="noopener noreferrer">rollup</a>,
    <a href="https://webpack.js.org/" target="_blank" rel="noopener noreferrer">webpack</a>,
    <a href="https://browserify.org/" target="_blank" rel="noopener noreferrer">browserify</a>, etc.
</p>
<p>A common usage of local modules is for loading shared helpers or configuration parameters, for example:</p>
<div class="code-wrapper prism-light svelte-1qrji6i"><code class="svelte-1qrji6i"><!-- HTML_TAG_START --><span class="token comment">// pb_hooks/utils.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">hello</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hello "</span> <span class="token operator">+</span> name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><!-- HTML_TAG_END --></code>
</div>
<div class="clearfix m-b-10"></div>

<div class="code-wrapper prism-light svelte-1qrji6i"><code class="svelte-1qrji6i"><!-- HTML_TAG_START --><span class="token comment">// pb_hooks/main.pb.js</span>
<span class="token function">onAfterBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__hooks<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/utils.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

    utils<span class="token punctuation">.</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><!-- HTML_TAG_END --></code>
</div>
<div class="alert alert-info m-t-10 m-b-sm"><div class="icon"><i class="ri-information-line"></i></div>
    <div class="content"><p>Loaded modules use a shared registry and mutations should be avoided when possible to prevent
            concurrency issues.
        </p></div></div>

<h5 id="performance" class="heading-link "><a href="#performance" class="link-primary">
        Performance
        </a></h5>
<p>The prebuilt executable comes with a <strong>prewarmed pool of 25 JS runtimes</strong>, which helps
    maintaining the handlers execution times on par with the Go equivalent code (see
    <a href="https://github.com/pocketbase/benchmarks/blob/master/results/hetzner_cax11.md#go-vs-js-route-execution" target="blank" rel="noopener noreferrer">benchmarks</a>). You can adjust the pool size manually with the <code>--hooksPool=100</code> flag (<em>increasing the pool size may improve the performance in high concurrent scenarios but also will
        increase the memory usage</em>).
</p>
<p>Note that the handlers performance may degrade if you have heavy computational tasks in pure JavaScript
    (eg. encryption, random generators, etc.). For such cases prefer using the exposed <a href="https://pocketbase.io/jsvm/index.html" target="_blank">Go bindings</a>
    (eg. <code>$security.randomString(10)</code>).
</p>

<h5 id="engine-limitations" class="heading-link "><a href="#engine-limitations" class="link-primary">
        Engine limitations
        </a></h5>
<p>We inherit some of the limitations and caveats of the embedded JavaScript engine
    
    (<a href="https://github.com/dop251/goja" target="_blank" rel="nopppener noreferrer">goja</a>):
</p>
<ul><li>Has most of ES6 functionality already implemented but it is not fully spec compliant yet.</li>
    <li>No concurrent execution inside a single handler (aka. no <code>setTimeout</code>/<code>setInterval</code>).
    </li>
    <li>Wrapped Go structural types (such as maps, slices) comes with some peculiarities and do not behave the
        exact same way as native ECMAScript values (for more details see
        <a href="https://pkg.go.dev/github.com/dop251/goja#Runtime.ToValue" target="blank" rel="noreferrer noopener">goja ToValue</a>).
    </li>
    <li>In relation to the above, DB <code>json</code> field values require the use of <code>get()</code> and
        <code>set()</code> helpers (<em>this may change in the future</em>).
    </li></ul></div>

    <hr>

    <div class="docs-footer svelte-1dbn67j">

    <a href="js-event-hooks.html" class="btn btn-outline btn-expanded btn-next svelte-1dbn67j"><span class="txt">Next: Event hooks</span>
            <i class="ri-arrow-right-line"></i></a>
</div></div></main>

<footer class="page-footer"><div class="wrapper wrapper-lg"><div class="primary-bar"><nav class="footer-col links"><a href="https://pocketbase.io/faq" class="link-item">FAQ</a>
                <a href="https://github.com/pocketbase/pocketbase/discussions" class="link-item" target="_blank" rel="noopener noreferrer">Discussions
                </a>
                <a href="https://pocketbase.io/docs" class="link-item">Documentation</a></nav>

            <nav class="footer-col links"><a href="https://github.com/pocketbase/js-sdk" class="link-item" target="_blank" rel="noopener noreferrer">JavaScript SDK
                </a>
                <a href="https://github.com/pocketbase/dart-sdk" class="link-item" target="_blank" rel="noopener noreferrer">Dart SDK
                </a></nav>

            <div class="footer-col socials"><div class="watermark-logo">Pocket<strong>Base</strong></div>
                <a href="mailto:support" class="btn btn-secondary btn-circle btn-hint social-item" aria-label="Contact support"><i class="ri-mail-line"></i></a>
                <a href="https://twitter.com/pocketbase" rel="noopener noreferrer" target="_blank" class="btn btn-secondary btn-circle btn-hint social-item" aria-label="Go to Twitter"><i class="ri-twitter-line"></i></a>
                <a href="https://github.com/pocketbase/pocketbase" rel="noopener noreferrer" target="_blank" class="btn btn-secondary btn-circle btn-hint social-item" aria-label="Go to GitHub"><i class="ri-github-line"></i></a></div></div>
        <div class="secondary-bar"><div class="terms"><span class="txt">© 2023-2024 Pocket<strong>Base</strong></span>
                <span class="gopher-credit">The Gopher artwork is from
                    <a href="https://github.com/marcusolsson/gophers" target="_blank" rel="noreferrer noopener">marcusolsson/gophers
                    </a></span></div>
            <div class="flex-fill"></div>
            <div class="credit">Crafted by <a href="https://gani.bg/" target="_blank" rel="noopener noreferrer" class="link-hint"><strong>Gani</strong></a></div></div></div></footer>



<button type="button" class="btn btn-circle btn-secondary scroll-to-top svelte-h1x6u4" arial-label="Go to top"><i class="ri-arrow-up-line"></i>
</button>


			
			<script>
				{
					__sveltekit_1pqcct0 = {
						base: new URL("../..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,null,null,null];

					Promise.all([
						import("../_app/immutable/entry/start.c884ba35.js"),
						import("../_app/immutable/entry/app.7b6d4e54.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 3, 42],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
</body>

<!-- Mirrored from pocketbase.io/docs/js-overview by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 26 Jun 2024 08:32:21 GMT -->
</html>
